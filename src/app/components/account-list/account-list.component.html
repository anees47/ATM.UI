<div class="container">
  <h1>ATM Account Management</h1>

  <div class="actions">
    <button (click)="createAccount()" [disabled]="loading" class="btn btn-primary">
      {{ loading ? 'Creating...' : 'Create New Account' }}
    </button>
    <button (click)="goToTransfer()" class="btn btn-secondary">Transfer Funds</button>
  </div>

  @if (error) {
    <div class="error-message">
      {{ error }}
    </div>
  }

  @if (success) {
    <div class="success-message">
      {{ success }}
    </div>
  }

  @if (loading && accounts.length === 0) {
    <div class="loading">
      Loading accounts...
    </div>
  }

  @if (!loading && accounts.length === 0) {
    <div class="no-accounts">
      No accounts found. Create your first account!
    </div>
  }

  @if (accounts.length > 0) {
    <div class="accounts-grid">
      @for (account of accounts; track account.id) {
        <div class="account-card">
          <div class="account-header">
            <div class="account-info">
              <span class="account-name">{{account.name}}</span>
              <div class="account-number" [title]="'Account Number'">{{ formatAccountNumber(account.id) }}</div>
            </div>
            <button (click)="viewTransactions(account.id)" class="btn-icon" title="View Transactions">
              â˜°
            </button>
          </div>
          <div class="balance-row">
            <span class="balance-label">Balance</span>
            <span class="balance-amount" [appCurrency]="account.balance" currencySymbol="$" [decimalPlaces]="2"></span>
          </div>
          <div class="account-actions">
            <button (click)="deposit(account.id)" class="btn btn-success btn-small">Deposit</button>
            <button (click)="withdraw(account.id)" class="btn btn-warning btn-small">Withdraw</button>
            <button (click)="confirmDelete(account.id)" class="btn btn-danger btn-small">Delete</button>
          </div>
        </div>
      }
    </div>
  }

  <!-- Create Account Dialog -->
  @if (showCreateDialog) {
    <app-create-account-dialog
      (accountSubmitted)="onAccountSubmitted($event)"
      (dialogClosed)="onDialogClosed()">
    </app-create-account-dialog>
  }

  <!-- Transfer Dialog -->
  @if (showTransferDialog) {
    <app-transfer-form
      (transferCompleted)="onTransferCompleted()"
      (dialogClosed)="onTransferDialogClosed()">
    </app-transfer-form>
  }

  <!-- Deposit/Withdraw Dialog -->
  @if (showDepositWithdrawDialog) {
    <app-deposit-withdraw-form
      [operationType]="operationType"
      [prefilledAccountId]="selectedAccountId"
      (operationCompleted)="onDepositWithdrawCompleted()"
      (dialogClosed)="onDepositWithdrawDialogClosed()">
    </app-deposit-withdraw-form>
  }
</div>
